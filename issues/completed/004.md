# Issue 004: XLSX Parser with Validation

## Branch Name
`issue/004-xlsx-parser`

## Objective
Create XLSX parser that outputs same format as CSV parser for consistency.

## Dependencies
- Issue 003 merged
- `xlsx` package

## Phase: RED - Write Failing Tests

### Test Cases (12+)
1. Valid XLSX with single sheet
2. XLSX with multiple sheets
3. Empty XLSX file
4. XLSX with formulas
5. XLSX with merged cells
6. XLSX with empty cells
7. XLSX with formatted numbers
8. XLSX with dates
9. Large XLSX file
10. XLSX with special characters
11. XLSX with hidden columns
12. Corrupted XLSX file

### Test File Location
`__tests__/unit/lib/xlsx-parser.test.ts`

### Git Commit
```bash
git commit -m "test: add failing tests for XLSX parser"
```

## Phase: GREEN - Implement

### Install Dependencies
```bash
npm install xlsx
```

### Implementation (`lib/xlsx-parser.ts`)
- Parse XLSX files
- Convert to same format as CSV parser
- Handle multiple sheets
- Type inference

### Git Commit
```bash
git commit -m "feat: implement XLSX parser"
```

## Phase: REFACTOR

### Refactoring Goals
- Normalize output format
- Add sheet selection
- Improve performance

### Git Commit
```bash
git commit -m "refactor: normalize XLSX parser output"
```

## Acceptance Criteria
- [ ] All 12+ tests pass
- [ ] Coverage >= 100%
- [ ] Output matches CSV parser format
- [ ] PR merged âœ…

## Estimated Effort
**M** (Medium)
